<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mi Biblioteca de Diarios</title>
<style>
body{
  background:#ffeef5;
  font-family:'Comic Neue',cursive;
  padding:20px;
  text-align:center;
}
h1{font-size:2em;margin-bottom:20px;}
button{
  background:#f28aa5;
  border:none;
  border-radius:12px;
  padding:10px 15px;
  color:white;
  font-size:1em;
  margin:5px;
  cursor:pointer;
}
button:hover{background:#f45c85;}
#biblioteca, #vistaDiario, #vistaEntrada{margin-top:20px;}
.card{
  background:#fff0f6;
  border-radius:16px;
  padding:15px;
  margin:10px auto;
  max-width:300px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
  cursor:pointer;
}
.hidden{display:none;}
#modal{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.4);
  display:flex;justify-content:center;align-items:center;
  z-index:100;
}
#modal.hidden{display:none;}
.modal-content{
  background:#fff0f6;
  border-radius:16px;
  padding:25px;
  width:90%;max-width:400px;
  box-shadow:0 6px 20px rgba(0,0,0,0.2);
  text-align:center;
}
#modal input,#modal textarea{
  width:100%;
  border:1px solid #fbb6ce;
  border-radius:12px;
  padding:10px;
  margin:10px 0;
  font-family:'Comic Neue',cursive;
  font-size:16px;
  resize:none;
}
#modal input:focus,#modal textarea:focus{outline:2px solid #f28aa5;}
.modal-buttons{display:flex;justify-content:space-between;margin-top:10px}
footer{
  margin-top:40px;
  font-size:14px;
  color:#7a7a7a;
}
</style>
</head>
<body>
<h1>üìö Mi Biblioteca de Diarios</h1>
<button id="newDiarioBtn">‚ûï Nuevo diario</button>
<div id="biblioteca"></div>
<div id="vistaDiario" class="hidden">
  <button id="backBiblioteca">‚¨ÖÔ∏è Volver</button>
  <h2 id="diarioNombre"></h2>
  <button id="newEntryBtn">‚ûï Nueva entrada</button>
  <div id="listaEntradas"></div>
</div>
<div id="vistaEntrada" class="hidden">
  <button id="backDiario">‚¨ÖÔ∏è Volver al diario</button>
  <h2 id="entradaTitulo"></h2>
  <p id="entradaFecha"></p>
  <p id="entradaContenido"></p>
</div>
<!-- MODAL -->
<div id="modal" class="hidden">
  <div class="modal-content">
    <h3 id="modalTitle">Nueva entrada</h3>
    <input id="modalInput" placeholder="T√≠tulo (puedes usar emojis ‚ú®)" />
    <textarea id="modalTextarea" placeholder="Contenido..." class="hidden"></textarea>
    <div class="modal-buttons">
      <button id="modalCancel">Cancelar</button>
      <button id="modalOk">Guardar</button>
    </div>
  </div>
</div>
<footer>P√°gina creada por Alejandra Triana</footer>
<script>
let biblioteca = JSON.parse(localStorage.getItem('bibliotecaDiarios')||'[]');
let diarioActivo = null;

const bibliotecaDiv = document.getElementById('biblioteca');
const vistaDiario = document.getElementById('vistaDiario');
const vistaEntrada = document.getElementById('vistaEntrada');
const listaEntradas = document.getElementById('listaEntradas');
const diarioNombre = document.getElementById('diarioNombre');
const entradaTitulo = document.getElementById('entradaTitulo');
const entradaFecha = document.getElementById('entradaFecha');
const entradaContenido = document.getElementById('entradaContenido');

const modal = document.getElementById('modal');
const modalTitle = document.getElementById('modalTitle');
const modalInput = document.getElementById('modalInput');
const modalTextarea = document.getElementById('modalTextarea');
const modalOk = document.getElementById('modalOk');
const modalCancel = document.getElementById('modalCancel');

function save(){localStorage.setItem('bibliotecaDiarios',JSON.stringify(biblioteca));}
function renderBiblioteca(){
  bibliotecaDiv.innerHTML='';
  biblioteca.forEach(d=>{
    const div=document.createElement('div');
    div.className='card';
    div.textContent=`${d.emoji} ${d.nombre} (${d.entradas.length})`;
    div.onclick=()=>{diarioActivo=d;renderDiario(d);};
    bibliotecaDiv.appendChild(div);
  });
  bibliotecaDiv.classList.remove('hidden');
  vistaDiario.classList.add('hidden');
  vistaEntrada.classList.add('hidden');
}
function renderDiario(d){
  diarioNombre.textContent=d.emoji+' '+d.nombre;
  listaEntradas.innerHTML='';
  d.entradas.forEach(e=>{
    const div=document.createElement('div');
    div.className='card';
    div.textContent=`${e.titulo} - ${new Date(e.fecha).toLocaleDateString()}`;
    div.onclick=()=>{
      entradaTitulo.textContent=e.titulo;
      entradaFecha.textContent=new Date(e.fecha).toLocaleString();
      entradaContenido.textContent=e.contenido;
      vistaEntrada.classList.remove('hidden');
      vistaDiario.classList.add('hidden');
    };
    listaEntradas.appendChild(div);
  });
  bibliotecaDiv.classList.add('hidden');
  vistaDiario.classList.remove('hidden');
}
function openModal({title,withContent=false,onOk}){
  modalTitle.textContent=title;
  modalInput.value='';
  modalTextarea.value='';
  modalTextarea.classList.toggle('hidden',!withContent);
  modal.classList.remove('hidden');

  function closeModal(){
    modal.classList.add('hidden');
    document.removeEventListener('keydown',escClose);
  }
  function escClose(e){if(e.key==='Escape')closeModal();}
  document.addEventListener('keydown',escClose);
  modalOk.onclick=()=>{
    const valTitle=modalInput.value.trim();
    const valContent=withContent?modalTextarea.value.trim():'';
    if(valTitle) onOk(valTitle,valContent);
    closeModal();
  };
  modalCancel.onclick=closeModal;
  modal.onclick=(e)=>{if(e.target===modal)closeModal();};
}

document.getElementById('newDiarioBtn').onclick=()=>{
  openModal({
    title:'Nuevo diario',
    onOk:(nombre)=>{
      const emoji=prompt('Emoji para el diario (ej. üìî):','üìî')||'üìî';
      biblioteca.push({id:'d'+Date.now(),nombre,emoji,entradas:[]});
      save();renderBiblioteca();
    }
  });
};
document.getElementById('newEntryBtn').onclick=()=>{
  openModal({
    title:'Nueva entrada',
    withContent:true,
    onOk:(titulo,contenido)=>{
      diarioActivo.entradas.unshift({id:'e'+Date.now(),titulo,contenido,fecha:new Date().toISOString()});
      save();renderDiario(diarioActivo);
    }
  });
};
document.getElementById('backBiblioteca').onclick=()=>renderBiblioteca();
document.getElementById('backDiario').onclick=()=>renderDiario(diarioActivo);
renderBiblioteca();
</script>
</body>
</html>

